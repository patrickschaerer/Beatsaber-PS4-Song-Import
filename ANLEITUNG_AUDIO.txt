# Anleitung: PS4 Beat Saber Audio ersetzen (Unity-Methode)

Diese Anleitung beschreibt den erfolgreichen Prozess zum Ersetzen von Audiodaten in einem PS4 Beat Saber AssetBundle mit UABEA, unter Verwendung des Unity Editors zur korrekten Vorbereitung der Audiodaten.

**Ausgangslage:**
- Eine `.wav`-Audiodatei deines Custom Songs (z.B. `BootySwing.wav`), vorzugsweise mit 44100 Hz.
- Unity 2018.1.6 installiert.
- UABEA.

---

### Teil 1: Audio in Unity vorbereiten (Erstellt Metadaten und die eigentlichen Audiodaten-Ressource)

1.  **Audio-Datei auf 44100 Hz bringen:** Stelle sicher, dass deine `.wav`-Audiodatei eine Abtastrate von 44100 Hz hat. Falls nicht, konvertiere sie mit `ffmpeg -i input.egg -ar 44100 output.wav`.

2.  **Neues Unity-Projekt erstellen:**
    *   Öffne Unity Hub, wähle Unity 2018.1.6 und erstelle ein neues "3D"-Projekt (z.B. `AudioBuilderProject`).

3.  **Audio-Datei importieren:**
    *   Ziehe deine `.wav`-Datei in den "Assets"-Ordner deines Unity-Projekts.

4.  **AudioClip in Szene referenzieren:**
    *   Öffne die Standardszene (z.B. "SampleScene").
    *   Gehe auf **GameObject > Audio > Audio Source**.
    *   Ziehe deine `.wav`-Datei aus dem "Project"-Fenster in das "AudioClip"-Feld der "Audio Source"-Komponente im Inspector. Speichere die Szene und das Projekt.

5.  **Spieler Build erstellen:**
    *   Gehe im Unity-Menü auf **File > Build Settings...**.
    *   Wähle "PC, Mac & Linux Standalone" und "Windows" als Zielplattform.
    *   Klicke auf "Add Open Scenes", um die aktuelle Szene hinzuzufügen.
    *   Klicke auf **"Build"**.
    *   Wähle einen leeren Ausgabeordner (z.B. `C:\Users\Dev-Box-User\BeatsaberConversion\UnityBuildOutput`).

---

### Teil 2: Audio-Metadaten-Dump und Ressourcendatei extrahieren (aus dem Spieler Build)

1.  **Build-Dateien finden:**
    *   Navigiere zu deinem Build-Ordner (z.B. `C:\Users\Dev-Box-User\BeatsaberConversion\UnityBuildOutput`).
    *   Gehe in den Unterordner mit dem Namen deines Projekts + `_Data` (z.B. `UnityBuildOutput_Data`).

2.  **UABEA öffnen:**
    *   Starte UABEA.

3.  **`sharedassets0.assets` öffnen:**
    *   Öffne die Datei `sharedassets0.assets` aus dem `_Data`-Ordner deines Unity Builds.

4.  **AudioClip finden:**
    *   Suche in der Asset-Liste nach dem `AudioClip` mit dem Namen deiner `.wav`-Datei (z.B. "AllNight").

5.  **AudioClip-Metadaten-Dump exportieren:**
    *   Wähle den `AudioClip` aus. Gehe auf **Plugins > Export Dump**.
    *   Speichere die `.txt`-Datei (z.B. `AllNight_dump.txt`) in deinem `BeatsaberConversion`-Ordner. Dies ist die Metadaten-Datei, die die Verweise enthält.

6.  **Die eigentliche Ressourcendatei finden:**
    *   Diese liegt im selben `_Data`-Ordner, aus dem du die `sharedassets0.assets` geöffnet hast. Sie hat den Namen `sharedassets0.resource`.

---

### Teil 3: Import in das Spiel-AssetBundle mit UABEA

1.  **Ziel-AssetBundle des Spiels öffnen:**
    *   Öffne in UABEA die **modifizierte AssetBundle-Datei des Spiels**, die den zu ersetzenden Song enthält (z.B. deine `ugh_fully_modded.bundle` oder die "dna"-Datei).

2.  **Alten AudioClip ersetzen (Metadaten):**
    *   Wähle den `AudioClip` des Originals (z.B. "Ugh") aus.
    *   Wähle Edit Data und kopiere die zwei Werte float m_Length = 166.72798 UInt64 m_Size = 8539424 vom Dump der Unitydatei (z.B. `AllNight_dump.txt`) 
    *   Speichere und schliesse diesen Bereich.

5.  **Alte Ressourcendatei ersetzen (Audiodaten):**
    *  Im AssetBundle wähle importieren und die passende sharedassets0.resource Datei. Kopiere dann den Namen der originalen *.ressource Datei und lösche diese.
	Nenne nun die sharedassets0.resource um mit dem vorher kopierten Namen der originalen .ressource Datei
6.  **Speichern:** Speichere die modifizierte AssetBundle-Datei über **File > Save**

---

### Teil 4: PKG neu erstellen und testen

1.  Verwende die endgültig modifizierte AssetBundle-Datei (z.B. `ugh_fully_modded.bundle`), um dein PKG neu zu erstellen.
2.  Installiere das neue PKG auf deiner PS4.
3.  Teste den Song in Beat Saber!
